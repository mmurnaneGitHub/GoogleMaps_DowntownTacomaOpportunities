$(document).on("pageshow","#pageone",function(){_1();$(window).on("orientationchange",function(_2){_1();});$(window).on("resize",function(){_1();});$(".show").click(function(){if($("#POI").outerWidth()>0){_3();}else{_4();}});$(".show_NewSitesTab").click(function(){if($("#POI").outerWidth()==0){_4();}dijit.byId("rightTabs").selectChild("NewSitesTab");});$(".show_ExistingSitesTab").click(function(){if($("#POI").outerWidth()==0){_4();}dijit.byId("rightTabs").selectChild("ExistingSitesTab");});$(".show_AmenitiesTab").click(function(){if($("#POI").outerWidth()==0){_4();}dijit.byId("rightTabs").selectChild("AmenitiesTab");});$(".show_CultureTab").click(function(){if($("#POI").outerWidth()==0){_4();}dijit.byId("rightTabs").selectChild("CultureTab");});function _4(){$("#theMap").animate({"width":$(window).width()-325+"px"},600);$("#POI").animate({"width":"325px"},600);};function _3(){$("#theMap").animate({"margin-right":"0","width":"100%"},600);$("#POI").animate({"width":"0"},600);};function _1(){$("#POI").width(0);$("#theMap").width("100%");$("#pageone").height($(window).height());$("#theMapHolder").height($(window).height()-$("[data-role=header]").outerHeight());$("#POI").height($(window).height()-$("[data-role=header]").outerHeight());$("#rightPane").height($(window).height()-$("[data-role=header]").outerHeight()-$("#headerPOI").outerHeight());};});var gmap=null;var overlay;var bounds;var dialog;var array_Markers=[];var markerGeoLocation;var panorama;var currentLat;var currentLong;var myRotate;var dataAll;var theMixedUseCount=1;var theResidentialCount=1;var theAmenitiesCount=1;var theCommercialCount=1;var shadow=new google.maps.MarkerImage("images/mapIcons/mm_20_shadow.png",new google.maps.Size(22,20),new google.maps.Point(0,0),new google.maps.Point(0,20));var shape={coord:[1,1,1,20,18,20,18,1],type:"poly"};var imageOver=new google.maps.MarkerImage("images/mapIcons/highlight.png",new google.maps.Size(12,20),new google.maps.Point(0,0),new google.maps.Point(0,20));function initialize(){var _5=new google.maps.LatLng(47.250138520439556,-122.47643585205077);var _6={zoom:12,center:_5,panControl:true,rotateControl:true,zoomControl:true,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.RIGHT_TOP},mapTypeControl:true,scaleControl:true,streetViewControl:true,overviewMapControl:false,mapTypeId:google.maps.MapTypeId.HYBRID};gmap=new google.maps.Map(document.getElementById("map_canvas"),_6);panorama=gmap.getStreetView();var _7=document.createElement("DIV");_7.style.padding="0px 10px 5px 5px";var _8=document.createElement("DIV");_8.style.backgroundColor="rgba(102,102,102,0.80)";_8.style.borderStyle="solid";_8.style.borderWidth="1px";_8.style.borderRadius="2px";_8.style.borderColor="#D2D4D7";_8.style.cursor="pointer";_8.style.width="26px";_8.style.height="26px";var _9=document.createElement("img");_9.src="images/locate.png";_9.style.width="20px";_9.style.height="20px";_9.style.margin="3px 0px 0px 3px";_9.title="Find my location";_8.appendChild(_9);_7.appendChild(_8);gmap.controls[google.maps.ControlPosition.RIGHT_TOP].push(_7);google.maps.event.addDomListener(_8,"click",function(){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(_a){if(markerGeoLocation){markerGeoLocation.setMap(null);markerGeoLocation=null;}else{var _b=new google.maps.LatLng(_a.coords.latitude,_a.coords.longitude);markerGeoLocation=new google.maps.Marker({position:_b,icon:"images/location.png",opacity:0.75,animation:google.maps.Animation.BOUNCE,map:gmap});gmap.setZoom(19);gmap.setCenter(_b);}});}});var _7=document.createElement("DIV");_7.style.padding="0px 10px 5px 5px";var _8=document.createElement("DIV");_8.style.backgroundColor="rgba(102,102,102,0.80)";_8.style.borderStyle="solid";_8.style.borderWidth="1px";_8.style.borderRadius="2px";_8.style.borderColor="#D2D4D7";_8.style.cursor="pointer";_8.style.width="26px";_8.style.height="26px";var _9=document.createElement("img");_9.src="images/homeWhite2.png";_9.style.width="20px";_9.style.height="20px";_9.style.margin="3px 0px 0px 3px";_9.title="Zoom to all development opportunities";_8.appendChild(_9);_7.appendChild(_8);gmap.controls[google.maps.ControlPosition.RIGHT_TOP].push(_7);google.maps.event.addDomListener(_8,"click",function(){gmap.fitBounds(bounds);});var _7=document.createElement("DIV");_7.style.padding="0px 10px 5px 5px";var _8=document.createElement("DIV");_8.style.backgroundColor="rgba(102,102,102,0.80)";_8.style.borderStyle="solid";_8.style.borderWidth="1px";_8.style.borderRadius="2px";_8.style.borderColor="#D2D4D7";_8.style.cursor="pointer";_8.style.width="26px";_8.style.height="26px";var _9=document.createElement("img");_9.src="images/extrude20.png";_9.style.width="20px";_9.style.height="20px";_9.style.margin="3px 0px 0px 3px";_9.title="Zoom to oblique view";_8.appendChild(_9);_7.appendChild(_8);gmap.controls[google.maps.ControlPosition.RIGHT_TOP].push(_7);google.maps.event.addDomListener(_8,"click",function(){gmap.setZoom(18);gmap.setMapTypeId(google.maps.MapTypeId.HYBRID);});var _7=document.createElement("DIV");_7.style.padding="0px 10px 5px 5px";var _8=document.createElement("DIV");_8.style.backgroundColor="rgba(102,102,102,0.80)";_8.style.borderStyle="solid";_8.style.borderWidth="1px";_8.style.borderRadius="2px";_8.style.borderColor="#D2D4D7";_8.style.cursor="pointer";var _9=document.createElement("img");_9.id="rotateButton";_9.src="images/play.png";_9.style.width="20px";_9.style.height="20px";_9.style.margin="3px 3px 0px 3px";_9.title="Auto rotate map";_8.appendChild(_9);_7.appendChild(_8);gmap.controls[google.maps.ControlPosition.RIGHT_TOP].push(_7);google.maps.event.addDomListener(_8,"click",function(){autoRotate(0);});overlay=new google.maps.OverlayView();overlay.draw=function(){};overlay.setMap(gmap);bounds=new google.maps.LatLngBounds();};function getFilePreventCache(){var _c={url:"Downtown.txt",handleAs:"json",preventCache:true,load:function(_d){dataAll=_d;var _e=dojox.json.query("$.items[/Group,/ID]",_d);var _f="";var _10="";var _11="";var _12="";var _13=0;for(var i=0;i<_e.length;i++){if(_e[i].Latitude>0&&_e[i].Longitude<0&&_e[i].Do_Not_Show!="x"&&_e[i].Do_Not_Show!="X"){if(_e[i].Image!=""){var _14=_e[i].Image;}else{var _14="NotAvailable";}var _15="<div style='color:rgb(56,64,142); font-weight:bold; font-style:italic; text-align:center; '>"+_e[i].Group+"</div>";_15+="<div style=\"text-align:center;\"><b>"+_e[i].Name+"</b>";_15+="<br><img src=\"images/locations/"+_14+"T.jpg\" style=\"width:75px;height:100px;margin:2px 5px 5px 0px;border:solid 1px #999;padding:2px\" />";_15+="<br><i>Click marker for details</i></div>";var _16="<span style='color:rgb(56,64,142);'>"+_e[i].Group+"</span>";_16+="<span>";if(_e[i].Name!=""){_16+=" - <i>"+_e[i].Name+"</i>";}_16+="</span>";var _17="<div style='clear:both;width: 330px;'>";_17+="<div style='clear:both;'>";_17+="<span style='color:rgb(56,64,142);'>"+_e[i].Address+"</span>";if(_e[i].length>19){_17+="<br>";}var _18=_e[i].Address.split(/,|\(/)[0];_18=_18.replace("&","and");_17+="&nbsp;|&nbsp;<a href=\"http://maps.google.com/maps?daddr="+_18+", Tacoma, WA\" target='_blank' onfocus='this.blur();' title='Get driving directions.'>Directions</a>";_17+="&nbsp;|&nbsp;<a href='javascript:go2studio("+_e[i].Latitude+", "+_e[i].Longitude+")' onfocus='this.blur();' title='Close this window and zoom map to location.'>Zoom</a>";_17+="&nbsp;|&nbsp;<a href='javascript:toggleStreetView("+_e[i].Latitude+", "+_e[i].Longitude+")' onfocus='this.blur();'  title='Zoom map to location and toggle Street-Indoor & Aerial View'>Street</a>";if(_e[i].Group=="Opportunity"){_17+="&nbsp;|&nbsp;<a title='Printable summary' href='javascript:printPage("+_e[i].ID+")'>Print</a>";}_17+="<br></div>";_17+="<div style='clear:both;'><hr color='#ACB1DB'></div>";_17+="<div style='clear:both;float:left;width:100px;'>";_17+="<a href=\"javascript:myLightbox('images/locations/"+_14+".jpg','"+_e[i].Name.replace(/'/g,"\\'")+"')\"><img style ='float:left;margin:2px 5px 5px 5px;border:solid 1px #999;padding:2px' src=\"images/locations/"+_14+"T.jpg\" title='Click to enlarge photo' height='100px' width='75px'></a>";_17+="</div>";_17+="<div style='float:left; width:210px;'>";var p=_e[i];for(key in p){if(key!="Group"&&key!="Category"&&key!="Name"&&key!="Latitude"&&key!="Longitude"&&key!="Address"&&key!="Image"&&key!="ID"&&key!="who"){if(p[key]!=""&&p[key]!="N/A"){_17+="<br><b>"+key+":  </b>"+p[key];}}}_17+="<br>&nbsp;</div>";_17+="</div>";var _19="";var _1a="<div style='clear:both;height:5px;'></div>";var _1b="<div style='clear:both;float:left;'><img src='images/mapIcons/";var _1c="'  ></div>";var _1d="<div style='float:left;'><img src=\"images/locations/"+_14+"T.jpg\" style=\"width:75px;height:100px;margin:2px 5px 0px 5px;border:solid 1px #999;padding:2px\" title=\""+_e[i].Name+" - Click to enlarge photo\" onclick=\"myLightbox('images/locations/"+_e[i].Image+".jpg','"+_e[i].Name.replace(/'/g,"\\'")+"')\" onmouseover='google.maps.event.trigger(array_Markers["+_13+"], \"mouseover\")'  onmouseout='google.maps.event.trigger(array_Markers["+_13+"], \"mouseout\")' /></div>";var _1e="<div style='padding:2px; margin: 2px;'><b>"+_e[i].Name+"</b><br>"+_e[i].Description+"</div>";_1e+="<div style='clear:both;'><a title='Zoom map to location and toggle Street-Indoor & Aerial View' href='javascript:toggleStreetView("+_e[i].Latitude+", "+_e[i].Longitude+")' >Street-Indoor & Aerial</a>";var _1f=" | <a href='javascript:google.maps.event.trigger(array_Markers["+_13+"], \"click\")' title='View complete property details.'>Details</a> | <a title='Printable summary' href='javascript:printPage("+_e[i].ID+")'>Printable</a></center>";var _20="</div><div style='clear:both;'><hr color='#ACB1DB'></div>";if(_e[i].Group=="Amenity"){_19="Y"+theMixedUseCount+".png";_11+=_1a+_1b+_19+_1c+_1d+_1e+_20;theMixedUseCount=theMixedUseCount+1;}else{if(_e[i].Group=="Key Buildings"){_19="P"+theResidentialCount+".png";_10+=_1a+_1b+_19+_1c+_1d+_1e+_20;theResidentialCount=theResidentialCount+1;}else{if(_e[i].Group=="Culture"){_19="G"+theAmenitiesCount+".png";_12+=_1a+_1b+_19+_1c+_1d+_1e+_20;theAmenitiesCount=theAmenitiesCount+1;}else{if(_e[i].Group=="Opportunity"){_19="C"+theCommercialCount+".png";_f+=_1a+_1b+_19+_1c+_1d+_1e+_1f+_20;theCommercialCount=theCommercialCount+1;}}}}addMarker(_e[i].Latitude,_e[i].Longitude,_15,_17,_16,_19);bounds.extend(new google.maps.LatLng(_e[i].Latitude,_e[i].Longitude));_13=_13+1;}}dojo.byId("Commercial1").innerHTML=_f;dojo.byId("Residential1").innerHTML=_10;dojo.byId("MixedUse1").innerHTML=_11;dojo.byId("Amenities1").innerHTML=_12;gmap.fitBounds(bounds);google.maps.event.addListenerOnce(gmap,"idle",function(){$(".show").click();});},error:function(_21){alert("An unexpected error occurred: "+_21);}};var _22=dojo.xhrGet(_c);};function addMarker(_23,_24,sum,_25,_26,_27){var _28=new google.maps.LatLng(_23,_24);var _29=new google.maps.MarkerImage("images/mapIcons/"+_27,new google.maps.Size(20,20),new google.maps.Point(0,0),new google.maps.Point(0,20));var _2a=new google.maps.Marker({position:_28,shadow:shadow,icon:_29,shape:shape,optimized:false,map:gmap});google.maps.event.addListener(_2a,"mouseover",function(){if(gmap.getBounds().contains(_2a.getPosition())){_2a.setIcon(imageOver);var evt=_2a.getPosition();var _2b=overlay.getProjection().fromLatLngToContainerPixel(evt);closeDialog();var _2c=new dijit.TooltipDialog({id:"tooltipDialog",content:sum,style:"position: absolute;z-index:100"});_2c.startup();dojo.style(_2c.domNode,"opacity",0.85);dijit.placeOnScreen(_2c.domNode,{x:_2b.x,y:_2b.y},["BL","TL","BR","TR"],{x:15,y:10});}});google.maps.event.addListener(_2a,"mouseout",function(){_2a.setIcon(_29);closeDialog();});google.maps.event.addListener(_2a,"click",function(){myDialog(_25,_26);});array_Markers.push(_2a);};function closeDialog(){var _2d=dijit.byId("tooltipDialog");if(_2d){_2d.destroy();}};function myDialog(_2e,_2f){myDlg=new dijit.Dialog({draggable:false});myDlg.titleNode.innerHTML=_2f;myDlg.attr("content",_2e);myDlg.show();dojo.connect(dijit._underlay,"onClick",function(e){myDlg.destroy();});};function myLightbox(url,_30){dialog.show({href:url,title:_30});};function PrintContent(){var _31=document.getElementById("directionsPanel");var _32=window.open("","PrintWindow","width=750,height=650,top=50,left=50,toolbars=no,scrollbars=yes,status=no,resizable=yes");_32.document.writeln(_31.innerHTML);_32.document.close();_32.focus();_32.print();};function go2studio(lat,lon){if(dojo.exists("myDlg")){myDlg.destroy();}var _33=new google.maps.LatLngBounds();var _34=new google.maps.LatLng(lat,lon);_33.extend(_34);gmap.setZoom(20);gmap.setCenter(_33.getCenter());};function printPage(id){var _35=dojox.json.query("$.items[?Group=='Opportunity' & Do_Not_Show=='' & ID=="+id+"]",dataAll);var _36=((_35[0].ID.charAt(0))==0)?_35[0].ID.charAt(1):_35[0].ID;var _37="<div style='width: 500px;text-align:center;'><img src='images/mapIcons/C"+_36+".png'><b>"+_35[0].Name+"</b></div>";_37+="<div style='width: 500px;text-align:center;'><i>"+_35[0].Address+"</i></div>";_37+="<div style='clear:both;width:500px;'>";_37+="<center><img style ='width: 500px;' src='images/locations/"+_35[0].Image+".jpg'></center>";_37+="</div>";_37+="<div style='float:left;width:240px;padding:5px;'>";var p=_35[0];for(key in p){if(key!="Group"&&key!="Category"&&key!="Name"&&key!="Latitude"&&key!="Longitude"&&key!="Address"&&key!="Image"&&key!="ID"&&key!="who"){if(p[key]!=""&&p[key]!="N/A"){if(key=="Description"){_37+="</div><div style='float:right; width:240px;padding:5px;'><span style='color:#615B6F;font-weight: bold;'>"+key+": </span>"+p[key]+"<br></div>";}else{_37+="<span style='color:#615B6F;font-weight: bold;'>"+key+": </span>"+p[key]+"<br>";}}}}myText="<html><HEAD><TITLE>Downtown Tacoma Development Opportunities</TITLE></HEAD><body>";myText+="<font face=verdana> <font size=-2><center><div style='width: 500px;background-color:#E9E5DC;padding:5px;margin-right: auto;margin-left: auto;text-align: left;'>";myText+="<div style='width: 500px;background-color:#C3BDAD;padding:2px 0px 2px 0px;text-align:center;margin-right:auto;margin-left:auto;'><b>Downtown Tacoma Development Opportunities</b></div>";myText+=_37;myText+="<img src='http://maps.google.com/maps/api/staticmap?center=";myText+=_35[0].Latitude+","+_35[0].Longitude;myText+="&zoom=16&size=500x350&maptype=hybrid&markers=color:blue|";myText+=_35[0].Latitude+","+_35[0].Longitude;myText+="&sensor=false' border=1></body></html>";myWindow=window.open("","","");myWindow.document.write(myText);myWindow.focus();};function toggleStreetView(_38,_39){if($("#theMap").width()<300){$("#POI").width(0);$("#theMap").width("100%");}var _3a=panorama.getVisible();gmap.setMapTypeId(google.maps.MapTypeId.HYBRID);gmap.setTilt(45);if(currentLat!=_38&&currentLong!=_39){_3a=false;}if(_3a==false){addLatLng=new google.maps.LatLng(_38,_39);var _3b=new google.maps.LatLngBounds();_3b.extend(addLatLng);gmap.setZoom(19);gmap.setCenter(_3b.getCenter());var _3c=new google.maps.StreetViewService();_3c.getPanoramaByLocation(addLatLng,50,showPanoData);}else{panorama.setVisible(false);}currentLat=_38;currentLong=_39;};function showPanoData(_3d,_3e){if(_3e!=google.maps.StreetViewStatus.OK){alert("Street View data not found for this location.");return;}var _3f=computeAngle(addLatLng,_3d.location.latLng);var _40={position:addLatLng,addressControl:true,linksControl:true,panControl:true,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL},pov:{heading:_3f,pitch:10,zoom:0},enableCloseButton:true,imageDateControl:true,visible:true};panorama.setOptions(_40);};function computeAngle(_41,_42){var _43=57.2957795;var _44=0.017453;var _45=_41.lat()-_42.lat();var _46=_41.lng()-_42.lng();var yaw=Math.atan2(_46*Math.cos(_41.lat()*_44),_45)*_43;return wrapAngle(yaw);};function wrapAngle(_47){if(_47>=360){_47-=360;}else{if(_47<0){_47+=360;}}return _47;};function rotate90(){var _48=gmap.getHeading()||0;gmap.setHeading(_48-90);};function autoRotate(_49,_4a){var str=document.getElementById("rotateButton").src;var n=str.search("pause.png");if(n!=-1){myStopFunction();}else{myStopFunction();if(_49!=0){addLatLng=new google.maps.LatLng(_49,_4a);var _4b=new google.maps.LatLngBounds();_4b.extend(addLatLng);gmap.setZoom(20);gmap.setCenter(_4b.getCenter());}if(gmap.getStreetView().getVisible()){gmap.getStreetView().setVisible(false);}if(gmap.getZoom()<18){gmap.setZoom(18);}gmap.setMapTypeId(google.maps.MapTypeId.HYBRID);gmap.setTilt(45);myRotate=window.setInterval(rotate90,3000);document.getElementById("rotateButton").src="images/pause.png";}};function myStopFunction(){clearInterval(myRotate);document.getElementById("rotateButton").src="images/play.png";};require(["dojo/parser","dijit/layout/TabContainer","dijit/layout/ContentPane","dojox/json/query","dojox/image/Lightbox","dijit/Dialog","dijit/TooltipDialog","dojo/domReady!"],function(_4c){_4c.parse();initialize();getFilePreventCache();dialog=new dojox.image.LightboxDialog().startup();});